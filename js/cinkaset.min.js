function hasId(c,b,a){a=a||"id";return c.some(function(d){return d[a]===b})}function showLoading(a,c,b){if(a){document.getElementById("loadtitle").textContent=c;document.getElementById("loadmessage").textContent=b;document.getElementById("loadscreen").classList.add("show")}else{document.getElementById("loadscreen").classList.remove("show")}}function loadingDone(d,b,a){document.getElementById("loadtitle").textContent=d;document.getElementById("loadmessage").textContent=b;var c=document.getElementById("loadscreen");c.classList.add("done");a=a||false;setTimeout(function(){c.classList.remove("show");c.classList.remove("done");if(a){m.redraw()}},2000)}var Reportdata=function(){var a={};a.error=m.prop("");a.report={};a.loadReport=function(c){var d=c[0];var b=new FileReader();b.onload=function(h){var g=JSON.parse(b.result);var i=[];var f=[];g.reportlist.forEach(function(e){f.push(e.slice(0,-12))});if(hasId(g["class"],"Succ","level")){f.push.apply(f,["c0","c1","c2","c3","c4"])}g.reports.forEach(function(j){for(var e in j.assoc){if(j.assoc.hasOwnProperty(e)){if(!hasId(i,e)){i.push({id:e,name:j.assoc[e]["name"].trim(),results:[]})}}}});i.forEach(function(e){g.reports.forEach(function(j){if(j.assoc.hasOwnProperty(e.id)){e.results.push({id:j.header,units:j.assoc[e.id]["units"],sales:j.assoc[e.id]["sales"],vmt:j.assoc[e.id]["vmt"],trans:j.assoc[e.id]["trans"]})}else{e.results.push({id:j.header,units:0,sales:0,vmt:0,trans:0})}});g["class"].forEach(function(j){if(j.level=="Succ"){j.assoc.forEach(function(k){if(k.assno===e.id){k.cats.forEach(function(n,l){e.results.push({id:"c"+l,data:n})})}})}})});console.log(f);console.log(i)};b.readAsText(d)};return a};var Reportapp={controller:function(b){var a={};a.data=b;return a},view:function(a){return m("div.container",[m("div.row.pt3",m("div.panel.panel-default",[m("div.panel-heading.app-title","Cinkaset"),m("div.panel-body.text-center",[m("span",{className:"btn btn-primary btn-lg btn-file"},[m("span#browsecaption","Charger un daily.report..."),m("input",{type:"file",onchange:m.withAttr("files",a.data.loadReport)})])])]))])}};